{% extends "base.html" %}
{% block title %}Espace Op√©rateur{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center mb-4">Espace Op√©rateur - {{ current_user.username }}</h2>

    <div class="card mb-4">
        <div class="card-header bg-primary text-white">‚ûï Nouvelle op√©ration</div>
        <div class="card-body">
            <form method="POST" action="{{ url_for('new_operation') }}">
                <div class="row">
                    <div class="col-md-6">
                        <label for="nom_operation">Nom de l'op√©ration</label>
                        <select name="nom_operation" class="form-control" required>
                            <option value="d√©bitage">D√©bitage</option>
                            <option value="assemblage">Assemblage</option>
                            <option value="soudage">Soudage</option>
                            <option value="travaux de finition">Travaux de finition</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label for="poste">Poste</label>
                        <input type="text" name="poste" class="form-control" required>
                    </div>
                </div>
                <button type="submit" class="btn btn-success mt-3">‚ûï Ajouter l'op√©ration</button>
            </form>
        </div>
    </div>

    <h4 class="mb-3">üìã Mes op√©rations</h4>
    <table class="table table-striped table-bordered">
        <thead class="thead-dark">
            <tr>
                <th>ID</th>
                <th>Op√©ration</th>
                <th>Poste</th>
                <th>Statut</th>
                <th>D√©but</th>
                <th>Fin</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for op in operations %}
            <tr>
                <td>{{ op.id }}</td>
                <td>{{ op.nom_operation }}</td>
                <td>{{ op.poste }}</td>
                <td>{{ op.statut }}</td>
                <td>{{ op.debut.strftime('%Y-%m-%d %H:%M') if op.debut else '' }}</td>
                <td>{{ op.fin.strftime('%Y-%m-%d %H:%M') if op.fin else '' }}</td>
                <td>
                    {% if op.statut == '√Ä faire' %}
                    <a href="{{ url_for('start_operation', op_id=op.id) }}" class="btn btn-sm btn-primary">‚ñ∂Ô∏è D√©marrer</a>
                    {% elif op.statut in ['En cours', 'Contr√¥le'] %}
                    <a href="{{ url_for('finish_operation', op_id=op.id) }}" class="btn btn-sm btn-success">‚úÖ Terminer</a>
                    {% else %}
                    <span class="text-muted">‚úîÔ∏è Termin√©</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
